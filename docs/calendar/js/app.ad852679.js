(function(t){function e(e){for(var l,o,r=e[0],i=e[1],c=e[2],u=0,p=[];u<r.length;u++)o=r[u],n[o]&&p.push(n[o][0]),n[o]=0;for(l in i)Object.prototype.hasOwnProperty.call(i,l)&&(t[l]=i[l]);d&&d(e);while(p.length)p.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],l=!0,r=1;r<a.length;r++){var i=a[r];0!==n[i]&&(l=!1)}l&&(s.splice(e--,1),t=o(o.s=a[0]))}return t}var l={},n={app:0},s=[];function o(e){if(l[e])return l[e].exports;var a=l[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=l,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var l in t)o.d(a,l,function(e){return t[e]}.bind(null,l));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],i=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=i;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"56d7":function(t,e,a){"use strict";a.r(e);var l=a("2b0e"),n=a("bb71");a("da64");l["a"].use(n["a"],{iconfont:"md"});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-toolbar",[a("v-toolbar-title",{staticClass:"headline"},[t._v("\n            カレンダー検索\n        ")]),a("v-spacer"),a("v-toolbar-items",[a("v-btn",{attrs:{flat:""}},[a("router-link",{attrs:{to:"/"}},[a("i",{staticClass:"material-icons"},[t._v("home")])])],1)],1)],1),a("v-content",[a("router-view")],1),a("v-footer",{attrs:{dark:"",height:"auto"}},[a("v-card",{staticClass:"flex",attrs:{flat:"",tile:""}},[a("v-card-actions",{staticClass:"grey darken-3 justify-center my-5 text-xs-center"},[t._v("\n                東京大学学術資産等アーカイブズ委員会事務局"),a("br"),t._v(" （東京大学附属図書館総務課／学術資産アーカイブ化推進室）\n                "),a("br"),t._v(" E-mail：digital-archive [at] lib.u-tokyo.ac.jp.\n            ")])],1)],1)],1)},o=[],r=a("2877"),i=a("6544"),c=a.n(i),d=a("7496"),u=a("8336"),p=a("b0af"),h=a("99d9"),f=a("549c"),v=a("553a"),m=a("9910"),y=a("71d9"),b=a("2a7f"),g={},x=Object(r["a"])(g,s,o,!1,null,null,null),_=x.exports;c()(x,{VApp:d["a"],VBtn:u["a"],VCard:p["a"],VCardActions:h["a"],VContent:f["a"],VFooter:v["a"],VSpacer:m["a"],VToolbar:y["a"],VToolbarItems:b["a"],VToolbarTitle:b["b"]});var C=a("8c4f"),k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-content",[a("v-container",{staticClass:"my-2"},[a("v-form",{ref:"form",staticClass:"mb-2"},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm4:""}},[a("v-text-field",{staticClass:"mx-2",attrs:{label:"キーワード / Keyword",name:"q"},model:{value:t.q,callback:function(e){t.q=e},expression:"q"}})],1),a("v-flex",{attrs:{xs12:"",sm4:""}},[a("v-select",{staticClass:"mx-2",attrs:{items:t.types,label:"資料種別 / Type",multiple:""},model:{value:t.type_array,callback:function(e){t.type_array=e},expression:"type_array"}})],1),a("v-flex",{attrs:{xs12:"",sm4:""}},[a("v-select",{staticClass:"mx-2",attrs:{items:t.collections,label:"コレクション / Collection",multiple:""},model:{value:t.collection_array,callback:function(e){t.collection_array=e},expression:"collection_array"}})],1)],1),a("v-btn",{attrs:{color:"primary"},on:{click:t.updatePath}},[a("i",{staticClass:"material-icons"},[t._v("search")])])],1),a("v-data-table",{staticClass:"elevation-1 mt-5",attrs:{items:t.items,"hide-actions":"","hide-headers":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("th",[t._v(t._s(e.item.year))]),t._l(12,function(l){return a("td",{staticClass:"text-xs-right"},[e.item.month[l-1]>0?a("router-link",{attrs:{to:{path:"list",query:{q:t.q,type:t.type,collection:t.collection,date:e.item.year+"-"+l}}}},[t._v(t._s(l)+"月 ("+t._s(e.item.month[l-1])+")")]):a("span",[t._v(t._s(l)+"月")])],1)})]}}])})],1)],1)],1)},q=[],w=a("dc09"),j=a("3cdd"),V=a.n(j),P=a("3e32"),O=a.n(P),E=a("a20c"),F=a.n(E),D=a("bc3a"),I=a.n(D);function N(t,e){var a=t.split(e);if(3!==a.length)return!1;const l=new Date(a[0],a[1]-1,a[2]);return a[0]===String(l.getFullYear())&&a[1]===("0"+(l.getMonth()+1)).slice(-2)&&a[2]===("0"+l.getDate()).slice(-2)}var T={components:{FullCalendar:w["a"]},data:function(){return{items:[],q:"",type:"Newspaper",type_array:["Newspaper"],types:[{value:"Newspaper",text:"新聞"},{value:"StillImage",text:"静止画資料"}],collection:"",collection_array:[],collections:[]}},watch:{$route(t,e){this.search()}},created:function(){let t=Object.assign({},this.$route.query);t.q&&(this.q=t.q),t.type&&(this.type=t.type,this.type_array=this.type.split(",")),t.collection&&(this.collection=t.collection,this.collection_array=this.collection.split(",")),this.search(),this.list_collections()},methods:{handleDateClick(t){window.open(t.event.id,"_blank")},updatePath(){this.type=this.type_array.join(","),this.collection=this.collection_array.join(","),this.$router.push({path:"",query:{q:this.q,type:this.type,collection:this.collection}})},list_collections(){let t=" PREFIX dcterms: <http://purl.org/dc/terms/> \n";t+=" PREFIX dcndl: <http://ndl.go.jp/dcndl/terms/> \n",t+=" select distinct ?collection \n",t+=" WHERE { \n",t+=" ?s dcterms:isPartOf ?collection . \n",t+=' filter(lang(?collection) = "ja") . \n',t+=" } order by desc(?collection) \n",console.log(t),I.a.get("https://sparql.dl.itc.u-tokyo.ac.jp?query="+encodeURIComponent(t)+"&output=json").then(t=>{let e=t.data.results.bindings;for(let a=0;a<e.length;a++){let t=e[a],l=t.collection.value;this.collections.push(l)}}).catch(t=>{console.log(t)})},search(){let t=" PREFIX dcterms: <http://purl.org/dc/terms/> \n";if(t+=" PREFIX dcndl: <http://ndl.go.jp/dcndl/terms/> \n",t+=" select distinct ?date count(distinct ?s) as ?c \n",t+=" WHERE { \n",t+=" ?s dcterms:date ?date . \n",this.type){let e=this.type.split(",");for(let a=0;a<e.length;a++)t+=" { ?s dcndl:materialType <http://ndl.go.jp/ndltype/"+e[a]+"> . } \n",a!=e.length-1&&(t+=" UNION \n")}if(this.collection){let e=this.collection.split(",");for(let a=0;a<e.length;a++)t+=" { ?s dcterms:isPartOf '"+e[a]+"'@ja . } \n",a!=e.length-1&&(t+=" UNION \n")}this.q&&(t+=" ?s ?p ?o . \n",t+=" ?o bif:contains '\""+this.q+"\"' . \n"),t+=" } order by desc(?date) \n",console.log(t),I.a.get("https://sparql.dl.itc.u-tokyo.ac.jp?query="+encodeURIComponent(t)+"&output=json").then(t=>{let e=t.data.results.bindings,a=[];this.items=a;var l=2e3,n=0,s={};for(let o=0;o<e.length;o++){let t=e[o],a=t.date.value,r=Number(t.c.value);if(N(a,"-")){let t=a.split("-"),e=Number(t[0]);e<l&&(l=e),e>n&&(n=e);let o=Number(t[1]);s[e]||(s[e]={});let i=s[e];i[o]||(i[o]=0),i[o]+=r}}for(let o=l;o<=n;o++){let t={year:o,month:[]},e=s[o];for(let a=1;a<=12;a++){let l=null!=e&&e[a]?e[a]:0;t.month.push(l)}a.push(t)}}).catch(t=>{console.log(t)})}}},R=T,S=(a("ca9c"),a("a523")),$=a("8fea"),M=a("0e8f"),U=a("4bd4"),A=a("a722"),X=a("b56d"),W=a("2677"),Y=Object(r["a"])(R,k,q,!1,null,null,null),B=Y.exports;c()(Y,{VApp:d["a"],VBtn:u["a"],VContainer:S["a"],VContent:f["a"],VDataTable:$["a"],VFlex:M["a"],VForm:U["a"],VLayout:A["a"],VSelect:X["a"],VTextField:W["a"]});var H=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-content",[a("v-container",{staticClass:"my-2"},[a("v-form",{ref:"form",staticClass:"mb-2"},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm3:""}},[a("v-text-field",{staticClass:"mx-2",attrs:{label:"キーワード / Keyword",name:"q"},model:{value:t.q,callback:function(e){t.q=e},expression:"q"}})],1),a("v-flex",{attrs:{xs12:"",sm3:""}},[a("v-text-field",{staticClass:"mx-2",attrs:{name:"date",label:"年月 / Year and Month"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),a("v-flex",{attrs:{xs12:"",sm3:""}},[a("v-text-field",{staticClass:"mx-2",attrs:{label:"資料種別 / Type",disabled:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}})],1),a("v-flex",{attrs:{xs12:"",sm3:""}},[a("v-text-field",{staticClass:"mx-2",attrs:{name:"コレクション / collection",label:"Collection",disabled:""},model:{value:t.collection,callback:function(e){t.collection=e},expression:"collection"}})],1),a("v-btn",{attrs:{color:"primary"},on:{click:t.updatePath}},[a("i",{staticClass:"material-icons"},[t._v("search")])])],1)],1),a("p",{staticClass:"text-xs-right"},[a("v-btn",{attrs:{color:"info"},on:{click:function(e){return t.move(-1)}}},[a("i",{staticClass:"material-icons"},[t._v("keyboard_arrow_left")])]),a("v-btn",{attrs:{color:"info"},on:{click:function(e){return t.move(1)}}},[a("i",{staticClass:"material-icons"},[t._v("keyboard_arrow_right")])])],1),a("FullCalendar",{ref:"fullCalendar",staticClass:"demo-app-calendar",attrs:{defaultView:"dayGridMonth",header:{left:"",center:"title",right:""},plugins:t.calendarPlugins,weekends:t.calendarWeekends,events:t.calendarEvents,defaultDate:t.defaultDate},on:{eventClick:t.handleDateClick}})],1)],1)],1)},J=[];function K(t,e){var a=t.split(e);if(3!==a.length)return!1;const l=new Date(a[0],a[1]-1,a[2]);return a[0]===String(l.getFullYear())&&a[1]===("0"+(l.getMonth()+1)).slice(-2)&&a[2]===("0"+l.getDate()).slice(-2)}function L(t){let e=t.getFullYear(),a=t.getMonth()+1;return a=a<10?"0"+a:a,e+"-"+a}var G={components:{FullCalendar:w["a"]},data:function(){return{calendarPlugins:[V.a,O.a,F.a],calendarWeekends:!0,calendarEvents:[],defaultDate:new Date("1918-01"),q:"",type:"",collection:"",date:"1918-01",collection:""}},watch:{$route(t,e){this.search()}},created:function(){let t=Object.assign({},this.$route.query);t.q&&(this.q=t.q),t.type&&(this.type=t.type),t.collection&&(this.collection=t.collection),t.date&&(this.defaultDate=new Date(t.date),this.date=L(this.defaultDate)),this.search()},methods:{handleDateClick(t){window.open(t.event.id,"_blank")},updatePath(){this.defaultDate=new Date(this.date),this.$router.push({path:"list",query:{q:this.q,type:this.type,date:this.date,collection:this.collection}})},search(){this.calendarEvents=[];let t=" PREFIX dcterms: <http://purl.org/dc/terms/> \n";if(t+=" PREFIX dcndl: <http://ndl.go.jp/dcndl/terms/> \n",t+=" select distinct ?link ?date ?title \n",t+=" WHERE { \n",this.type){let e=this.type.split(",");for(let a=0;a<e.length;a++)t+=" { ?s dcndl:materialType <http://ndl.go.jp/ndltype/"+e[a]+"> . } \n",a!=e.length-1&&(t+=" UNION \n")}if(this.collection){let e=this.collection.split(",");for(let a=0;a<e.length;a++)t+=" { ?s dcterms:isPartOf '"+e[a]+"'@ja . } \n",a!=e.length-1&&(t+=" UNION \n")}t+=" ?s dcterms:date ?date . \n",t+=" ?date bif:contains '\""+this.date+"\"' . \n",t+=" ?s dcterms:title ?title . \n",t+=" ?s rdfs:seeAlso ?link . \n",this.q&&(t+=" ?s ?p ?o . \n",t+=" ?o bif:contains '\""+this.q+"\"' . \n"),t+=" } order by desc(?date) \n",I.a.get("https://sparql.dl.itc.u-tokyo.ac.jp?query="+encodeURIComponent(t)+"&output=json").then(t=>{let e=t.data.results.bindings,a=[];for(let l=0;l<e.length;l++){let t=e[l],n=t.date.value;if(K(n,"-")){a.push({title:t.title.value,start:t.date.value,id:t.link.value})}}this.calendarEvents=a}).catch(t=>{console.log(t)})},move(t){let e=this.$refs.fullCalendar.getApi();-1==t?e.prev():e.next();let a=e.getDate();this.date=L(a),this.updatePath()}}},z=G,Q=(a("abcb"),Object(r["a"])(z,H,J,!1,null,null,null)),Z=Q.exports;c()(Q,{VApp:d["a"],VBtn:u["a"],VContainer:S["a"],VContent:f["a"],VFlex:M["a"],VForm:U["a"],VLayout:A["a"],VTextField:W["a"]}),l["a"].use(C["a"]);var tt=new C["a"]({routes:[{path:"/",name:"index",component:B},{path:"/list",name:"list",component:Z}]});l["a"].config.productionTip=!1,new l["a"]({router:tt,render:function(t){return t(_)}}).$mount("#app")},"650b":function(t,e,a){},"9b5a":function(t,e,a){},abcb:function(t,e,a){"use strict";var l=a("9b5a"),n=a.n(l);n.a},ca9c:function(t,e,a){"use strict";var l=a("650b"),n=a.n(l);n.a}});
//# sourceMappingURL=app.ad852679.js.map